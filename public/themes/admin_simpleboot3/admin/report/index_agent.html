<include file="public@header"/>
<link id="beyond-link" href="__TMPL__/public/assets/css/beyond.min.css" rel="stylesheet"/>
</head>
<body>
<div class="wrap js-check-wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="{:url('report/index')}">统计报表</a></li>
        <!--<li><a href="{:url('user/add')}">添加会员</a></li>-->
    </ul>
    <div class="row">
        <div class="col-lg-4 col-sm-6 col-xs-12">
            <div class="databox databox-lg radius-bordered databox-shadowed databox-graded">
                <div class="databox-left bg-azure">
                    <div class="databox-piechart">
                        <div data-toggle="easypiechart" class="easyPieChart" data-barcolor="#fff" data-linecap="butt"
                             data-percent="{$newviptotalrate}" data-animate="500" data-linewidth="3" data-size="60"
                             data-trackcolor="#7fe2fa"><span class="white font-90">{$newviptotalrate}%</span>
                        </div>
                    </div>
                </div>
                <div class="databox-right">
                    <span class="databox-number azure">今日：{$newvipToday}&nbsp;&nbsp;昨日：{$newvipYesterday}</span>
                    <div class="databox-text darkgray">新增会员
                        <div class="databox-stat bg-azure radius-bordered">
                            <div class="stat-text">环比：{$newviprate}%</div>
                            <gt name="newviprate" value="0">
                                <i class="stat-icon fa fa-arrow-up"></i>
                                <else/>
                                <i class="stat-icon fa fa-arrow-down"></i>
                            </gt>
                        </div>
                    </div>
                </div>
            </div>
            <div class="databox databox-xlg radius-bordered databox-shadowed databox-vertical">
                <div class="databox-top bg-blue">
                    <span class="databox-header">会员分布【总数：{$viptotal}人】</span>
                </div>
                <div class="databox-bottom bg-white no-padding" style=" height: 230px;">
                    <div id="vip-chart" class="chart chart"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-4 col-sm-6 col-xs-12">
            <div class="databox databox-lg radius-bordered databox-shadowed databox-graded">
                <div class="databox-left bg-orange">
                    <div class="databox-piechart">
                        <div data-toggle="easypiechart" class="easyPieChart" data-barcolor="#fff" data-linecap="butt"
                             data-percent="{$newordertotalrate}" data-animate="500" data-linewidth="3" data-size="60"
                             data-trackcolor="#fa8872"><span class="white font-90">{$newordertotalrate}%</span>
                        </div>
                    </div>
                </div>
                <div class="databox-right">
                    <span class="databox-number orange">今日：{$neworderToday}&nbsp;&nbsp;昨日：{$neworderYesterday}</span>
                    <div class="databox-text darkgray">新接任务
                        <div class="databox-stat bg-orange radius-bordered">
                            <div class="stat-text">环比：{$neworderrate}%</div>
                            <gt name="neworderrate" value="0">
                                <i class="stat-icon fa fa-arrow-up"></i>
                                <else/>
                                <i class="stat-icon fa fa-arrow-down"></i>
                            </gt>
                        </div>
                    </div>
                </div>
            </div>
            <div class="databox databox-xlg radius-bordered databox-shadowed databox-vertical">
                <div class="databox-top bg-orange">
                    <span class="databox-header">已抢次数【总数：{$ordertotal}次】</span>
                </div>
                <div class="databox-bottom bg-white no-padding" style=" height: 230px;">
                    <div id="order-chart" class="chart chart"></div>
                </div>
            </div>
        </div>

        <div class="col-lg-4 col-sm-6 col-xs-12">
            <div class="databox databox-lg radius-bordered databox-shadowed databox-graded">
                <div class="databox-left bg-palegreen">
                    <div class="databox-piechart">
                        <div data-toggle="easypiechart" class="easyPieChart" data-barcolor="#fff" data-linecap="butt"
                             data-percent="{$newyongtotalrate}" data-animate="500" data-linewidth="3" data-size="60"
                             data-trackcolor="#aadc95"><span class="white font-90">{$newyongtotalrate}%</span>
                        </div>
                    </div>
                </div>
                <div class="databox-right">
                    <span class="databox-number green">今日：{$newyongToday|number_format=###,2}&nbsp;&nbsp;昨日：{$newyongYesterday|number_format=###,2}</span>
                    <div class="databox-text darkgray">新增佣金
                        <div class="databox-stat bg-palegreen radius-bordered">
                            <div class="stat-text">环比：{$newyongrate}%</div>
                            <gt name="newyongrate" value="0">
                                <i class="stat-icon fa fa-arrow-up"></i>
                                <else/>
                                <i class="stat-icon fa fa-arrow-down"></i>
                            </gt>
                        </div>
                    </div>
                </div>
            </div>
            <div class="databox databox-xlg radius-bordered databox-shadowed databox-vertical">
                <div class="databox-top bg-palegreen">
                    <span class="databox-header">佣金分布【总佣金：{$yongtotal|number_format=###,2}元】</span>
                </div>
                <div class="databox-bottom bg-white no-padding" style=" height: 230px;">
                    <div id="fx-chart" class="chart chart"></div>
                </div>
            </div>
        </div>
    </div>
    <div style="clear: both;"></div>
    <div class="row" style="margin-top: 80px;">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div id="vipnum" class="chart chart">

            </div>
        </div>
    </div>
    <div style="clear: both;"></div>
    <div class="row" style="margin-top: 80px;">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="row">
                <div class="col-xs-12">
                    <div class="dashboard-box">
                        <div class="box-progress">
                            <div class="progress-handle">尉氏后台</div>
                            <div class="progress progress-xs progress-no-radius bg-whitesmoke">
                                <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0"
                                     aria-valuemax="100" style="width: 20%">
                                </div>
                            </div>
                        </div>
                        <div class="box-days">
                            <div class="row">
                                <div class=" col-lg-6 col-md-2 col-sm-6 col-xs-12">
                                    <a class="day-container" href="">
                                        <div class="day">{$yongtotal|number_format=###,2}元</div>
                                        <div class="month">发放佣金</div>
                                    </a>
                                </div>
                                <div class=" col-lg-6 col-md-2 col-sm-6 col-xs-12">
                                    <a class="day-container " href="">
                                        <div class="day">{$cashtotal|number_format=###,2}元</div>
                                        <div class="month">发放提现</div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="__STATIC__/js/admin.js"></script>
    <script src="__TMPL__/public/assets/js/beyond.js"></script>
    <!--统计脚本-->
    <script src="__TMPL__/public/assets/js/charts/easypiechart/jquery.easypiechart.js"></script>
    <script src="__TMPL__/public/assets/js/charts/easypiechart/easypiechart-init.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.orderBars.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.tooltip.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.resize.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.selection.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.crosshair.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.stack.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.time.js"></script>
    <script src="__TMPL__/public/assets/js/charts/flot/jquery.flot.pie.js"></script>
    <script src="__TMPL__/public/assets/js/charts/chartjs/Chart.js"></script>
    <!--图表特性封装-->
    <script type="text/javascript">
        InitiateEasyPieChart.init();
    </script>
    <!--图表逻辑-->
    <script type="text/javascript">
        themeprimary = getThemeColorFromCss('themeprimary');
        themesecondary = getThemeColorFromCss('themesecondary');
        themethirdcolor = getThemeColorFromCss('themethirdcolor');
        themefourthcolor = getThemeColorFromCss('themefourthcolor');
        themefifthcolor = getThemeColorFromCss('themefifthcolor');
        themesixthcolor = '#AC193D';
        themeseventhcolor = '#001940';

        function labelFormatter(label, series) {
            return "<div style='font-size:8pt; text-align:center; padding:2px; color:white;'>" + label + "<br/>" + Math.round(series.percent) + "%</div>";
        }

        //会员
        var vip1 = "{$putongvip}"; //普通会员
        var vip2 = "{$czvip}"; //VIP会员
        var vipwrap = $("#vip-chart");
        var vipdata = [{
            label: "普通会员",
            data: [
                [1, vip1]
            ],
            color: themeprimary
        }, {
            label: "VIP会员",
            data: [
                [1, vip2]
            ],
            color: themefifthcolor
        }];

        $.plot(vipwrap, vipdata, {
            series: {
                pie: {
                    show: true,
                    radius: 1,
                    tilt: 0.5,
                    label: {
                        show: true,
                        radius: 1,
                        formatter: labelFormatter,
                        background: {
                            opacity: 0.8
                        }
                    },
                    combine: {
                        color: "#999",
                        threshold: 0.1
                    }
                }
            },
            legend: {
                show: false
            }
        });
        //任务分布
        var order0 = "{$goingorder}"; //进行中
        var order1 = "{$finishorder}"; //已完成
        var orderwrap = $("#order-chart");
        var orderdata = [{
            label: "进行中",
            data: [
                [1, order0]
            ],
            color: themeprimary
        }, {
            label: "已完成",
            data: [
                [1, order1]
            ],
            color: themesecondary
        }];

        $.plot(orderwrap, orderdata, {
            series: {
                pie: {
                    show: true,
                    radius: 1,
                    tilt: 0.5,
                    label: {
                        show: true,
                        radius: 1,
                        formatter: labelFormatter,
                        background: {
                            opacity: 0.8
                        }
                    },
                    combine: {
                        color: "#999",
                        threshold: 0.1
                    }
                }
            },
            legend: {
                show: false
            }
        });
        //分销分布
        var fx1 = "{$fxyong}"; //vip佣金
        var fx2 = "{$gudingyong}"; //vip佣金
        var fxwrap = $("#fx-chart");
        var fxdata = [{
            label: "vip佣金",
            data: [
                [1, fx1],
                [1, fx2]
            ],
            color: themeprimary
        }];

        $.plot(fxwrap, fxdata, {
            series: {
                pie: {
                    show: true,
                    radius: 1,
                    tilt: 0.5,
                    label: {
                        show: true,
                        radius: 1,
                        formatter: labelFormatter,
                        background: {
                            opacity: 0.8
                        }
                    },
                    combine: {
                        color: "#999",
                        threshold: 0.1
                    }
                }
            },
            legend: {
                show: false
            }
        });
    </script>
    <script>
        Date.prototype.Format = function (fmt) {
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        };

        var currentDate = new Date();
        var arr = [
            [1, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() - 6).Format("MM-dd")],
            [2, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() - 5).Format("MM-dd")],
            [3, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() - 4).Format("MM-dd")],
            [4, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() - 4).Format("MM-dd")],
            [5, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() - 3).Format("MM-dd")],
            [6, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate() - 1).Format("MM-dd")],
            [7, new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate()).Format("MM-dd")],
        ];
        var lineData = '{$line}'
        lineData = eval('(' + lineData + ')')
        var d1 = []
        var d2 = []
        $(function () {
            var tmpPutong = tmpVip = tmpAgent = 0;
            for (var i = 1; i <= 7; i++){
                tmpPutong = lineData.putong[i-1]
                d1.push([i,tmpPutong])
                tmpVip = lineData.vip[i-1]
                d2.push([i,tmpVip])
            }
            $.plot("#vipnum", [{
                data: d1,
                label: "普通会员",
                points: {show: true},
                lines: {show: true},
                xaxis: {ticks: arr},
                color: themeprimary
            }, {
                data: d2,
                label: "VIP会员",
                points: {show: true},
                lines: {show: true},
                xaxis: {ticks: arr},
                color: themesecondary
            }], {
                xaxis: {
                    ticks: arr
                }
            });

        });
    </script>
</body>
</html>